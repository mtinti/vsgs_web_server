<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T. brucei VSG Modulation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* bg-gray-900 */
        }
        /* --- General & Nav --- */
        .nav-link {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-link.active {
            border-bottom-color: #4f46e5; /* indigo-600 */
            color: #e5e7eb; /* gray-200 */
        }
        .filter-btn {
            transition: all 0.3s ease;
        }
        .filter-btn.active {
            background-color: #4f46e5; /* bg-indigo-600 */
            color: white;
            box-shadow: 0 4px 14px 0 rgba(79, 70, 229, 0.39);
        }
        .page-container {
            display: none; /* Hidden by default */
        }
        .page-container.active {
            display: block; /* Shown when active */
        }
        #tooltip {
            position: fixed;
            display: none;
            background-color: rgba(17, 24, 39, 0.8); /* bg-gray-900 with opacity */
            backdrop-filter: blur(4px);
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem; /* rounded-lg */
            font-size: 0.875rem; /* text-sm */
            pointer-events: none; /* Allows mouse events to pass through */
            z-index: 100;
            transition: opacity 0.2s;
            border: 1px solid rgba(75, 85, 99, 0.5);
        }

        /* --- Leaderboard Specific --- */
        #leaderboard-container {
            transition: height 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .leaderboard-item {
            position: absolute;
            width: calc(100% - 1rem);
            left: 0.5rem;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.6s ease;
            will-change: transform, opacity;
        }
        .rank-badge {
            transition: background-color 0.5s ease;
        }
        .rank-1 { background-color: #fbbf24; color: #422006;}
        .rank-2 { background-color: #d1d5db; color: #1f2937;}
        .rank-3 { background-color: #f59e0b; color: #451a03;}

        /* --- Diverging Chart Specific --- */
        #chart-container {
            transition: height 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .chart-item {
            position: absolute;
            width: 100%;
            height: 40px;
            display: flex;
            align-items: center;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            will-change: transform;
        }
        .diverging-bar { /* Renamed from .bar to avoid conflict */
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            height: 24px;
            border-radius: 0.375rem;
            transition: width 0.6s ease, background-color 0.3s ease;
        }
        .bar-up {
            left: 50%;
            background-color: #2563eb; /* bg-blue-600 */
        }
        .bar-down {
            right: 50%;
            background-color: #dc2626; /* bg-red-600 */
        }
        .center-axis {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #4b5563; /* bg-gray-600 */
        }
        .item-label {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.875rem;
            color: #d1d5db;
            white-space: nowrap;
            padding: 0 0.5rem;
        }
    </style>
</head>
<body class="text-white antialiased">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-5xl">
        
        <!-- Navigation -->
        <nav class="flex justify-center gap-6 mb-8">
            <a href="#" id="nav-silent" class="nav-link active text-gray-400 font-medium pb-1">Silent VSG Modulation</a>
            <a href="#" id="nav-main" class="nav-link text-gray-400 font-medium pb-1">Main VSG Modulation</a>
        </nav>

        <!-- Page 1: Silent VSG Leaderboard -->
        <div id="page-silent" class="page-container active">
            <header class="text-center mb-8">
                <h1 class="text-3xl sm:text-4xl font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-cyan-400">
                    Trypanosoma Brucei Silent VSGs Modulation
                </h1>
                <p class="mt-2 text-lg text-gray-400">Interactive Leaderboard</p>
            </header>
            <div id="filters-silent" class="flex flex-wrap justify-center gap-2 sm:gap-3 mb-8">
                <button data-sort="sum" class="filter-btn active font-semibold py-2 px-4 rounded-full bg-gray-800 hover:bg-gray-700">Overall Impact (Sum)</button>
                <button data-sort="BES" class="filter-btn font-semibold py-2 px-4 rounded-full bg-gray-800 hover:bg-gray-700">BES</button>
                <button data-sort="MC" class="filter-btn font-semibold py-2 px-4 rounded-full bg-gray-800 hover:bg-gray-700">MC</button>
                <button data-sort="MES" class="filter-btn font-semibold py-2 px-4 rounded-full bg-gray-800 hover:bg-gray-700">MES</button>
                <button data-sort="array" class="filter-btn font-semibold py-2 px-4 rounded-full bg-gray-800 hover:bg-gray-700">Array</button>
            </div>
            <div id="leaderboard-container" class="relative w-full mx-auto max-w-4xl"></div>
            <div id="expander-container" class="text-center mt-6"></div>
        </div>

        <!-- Page 2: Main VSG Diverging Chart -->
        <div id="page-main" class="page-container">
             <header class="text-center mb-8">
                <h1 class="text-3xl sm:text-4xl font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-blue-500">
                    Main VSG Modulation
                </h1>
                <p class="mt-2 text-lg text-gray-400">Up-regulation vs. Down-regulation</p>
            </header>
            <div id="filters-main" class="flex flex-wrap justify-center gap-2 sm:gap-3 mb-8">
                <button data-sort="magnitude" class="filter-btn active font-semibold py-2 px-4 rounded-full bg-gray-800 hover:bg-gray-700">Biggest Changes</button>
                <button data-sort="up" class="filter-btn font-semibold py-2 px-4 rounded-full bg-gray-800 hover:bg-gray-700">Top Up-regulated</button>
                <button data-sort="down" class="filter-btn font-semibold py-2 px-4 rounded-full bg-gray-800 hover:bg-gray-700">Top Down-regulated</button>
            </div>
            <div class="relative w-full bg-gray-800/50 rounded-lg p-4 sm:p-6">
                <div class="flex justify-between text-xs text-gray-400 mb-2 px-2">
                    <span>Down-regulated</span>
                    <span>Up-regulated</span>
                </div>
                <div id="chart-container" class="relative w-full">
                    <div class="center-axis"></div>
                </div>
            </div>
        </div>
        <div id="loader" class="text-center py-10"><p class="text-gray-400">Loading data...</p></div>
    </div>

    <div id="tooltip"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DATA ---
            const silentCsvData = `Experiment,BES,MC,MES,array,sum
BDF2_1_KO48,1.596840899669176e-05,3.205348282546384e-06,2.5048734833434104e-05,9.522602636504114e-06,5.374509474917637e-05
BDF3_1_KO24,0.00019354670822812993,0.000172613409905105,0.00016086841462898167,5.287967745876883e-05,0.0005799082102209854
BET151_1_Drug12h,6.093452811295711e-07,4.073485171019887e-07,0.0,8.178121095266588e-07,1.8345059077582187e-06
BET151_1_Drug24h,1.0915564099960028e-07,4.0499382219868203e-07,3.4740661933549157e-07,1.6505113238775628e-06,2.5120674064113368e-06
BET151_1_Drug3h,3.3889563212748896e-06,9.134814306645722e-07,1.7288643103335434e-07,1.4195470124335527e-06,5.894871195406369e-06
BET151_1_Drug48h,5.006665151452495e-07,8.964501797690419e-07,1.448303224586434e-05,8.00626960687772e-06,2.3886418547656353e-05
BET151_1_Drug6h,2.4816969885653292e-06,5.022537061926255e-07,4.0814188265425846e-07,1.4819256906941858e-06,4.874018268106399e-06
BET151_1_Drug72h,4.576302211479651e-06,2.2998203625461016e-06,9.573128453787476e-05,2.4456676069834817e-05,0.00012706408318173532
CAF1b_1_RNAi24,0.001491137417081523,0.0013631119298203394,0.0017777871479143375,0.0005546510666701215,0.005186687561486322
CFB2_1_RNAi9,1.0524542593471877e-05,6.333421653686128e-06,5.075341458946935e-05,9.620831763858441e-06,7.723221060048579e-05
DFO_1_DFO,3.0643941575053756e-06,3.0646225138041096e-06,3.855205582830246e-06,1.5968009027542767e-06,1.1581023156894008e-05
DFO_1_DFOFe,5.867651568940588e-07,2.6159111355482137e-07,0.0,1.0682575951499075e-06,1.9166138655987877e-06
DFO_1_Fe,1.1434797331230343e-06,4.030433011332701e-07,4.712476428220824e-07,1.1518150065625365e-06,3.1695856836409235e-06
DRBD18_1_RNAi12,1.6117494426702205e-07,2.779016842363336e-07,0.0,9.54110517206969e-07,1.3931871457103247e-06
H1_1_RNAi96,0.0006420475268194033,3.0024398774005396e-05,2.7932461190117006e-05,2.4780879880084957e-05,0.0007247852666636106
H3H4_1_KOH3,5.621460582341407e-05,0.00022447937311976556,7.577529638340572e-05,1.4562161238291103e-05,0.0003710314365648764
H3H4_1_KOH3J,0.00014676017519478965,0.00026722127769158375,0.00020273255745159097,5.5290064533479716e-05,0.0006720040748714441
H3H4_1_KOH4,4.956071562401464e-06,9.512104075450287e-07,1.3306997223268921e-06,2.229555505629407e-06,9.467537197902792e-06
H3H4_1_KOH4J,1.8052196994094808e-06,1.673056530115095e-06,2.256429205456218e-06,3.3097552711355745e-06,9.044460706116367e-06
H3H4_1_KOJ2,1.5464589641890135e-08,3.736842761505646e-07,0.0,2.343724997842363e-06,2.7328738636348176e-06
H3H4_2_KO48,0.00010627981481282743,0.00014479130990100838,0.004479759341276457,0.0005562286696076623,0.005287059135597955
H3H4_3_KO48,0.00011578311645494774,9.09146987051421e-05,0.005181987870089326,0.000639596890099303,0.0060282825753487194
H3_1_KOH3,0.00014562143518928732,0.0004727280496369994,7.437452111901813e-05,2.8378690100127842e-05,0.0007211026960454327
H3_1_KOH3J,0.00016593959493312925,0.0005851954319887471,9.462952677126249e-05,5.599437935409422e-05,0.0009017589330472331
H3_1_KOJ,3.559853013925152e-08,1.238096630837081e-05,1.6300400829290914e-06,7.65724352035657e-06,2.1703848441795724e-05
IPMK_1_RNAi36,0.00014786575689523738,4.168277701312397e-06,2.9013016402535215e-05,2.504033747006065e-05,0.00020608738846914564
IPMK_2_RNAi36,3.9284498454181805e-05,4.121465498927408e-06,2.4545148091198177e-06,4.52120074322217e-05,9.107248619445073e-05
MCMBP_1_KO24,0.00020636750063561456,9.703436719937793e-05,0.000131625100309031,2.5093538314585496e-05,0.000460120506458609
MCMBP_1_KO48,0.0002755923012061654,0.00012998614388146893,0.00033389773669039737,0.00013965997421305928,0.0008791361559910909
PIP5Pase_1_KO,0.005987506260541362,0.004852047167884353,0.010349834663886238,0.0115261656167629,0.032715553709074856
PIP5Pase_2_D360A_N362A,0.0021172425018530588,0.0015311905840479677,0.0018013418624818326,0.0034013430424952923,0.008851117990878152
PNUTS_1_RNAi48,6.209792818894519e-05,0.00013531153008777326,0.00037953308507166075,8.44586101610138e-05,0.000661401153509393
RBP10_1_RNAi24,1.1650601721795951e-06,1.7093984287807508e-06,1.8590494401083094e-07,1.1361521934691115e-05,1.4421885479662292e-05
RBP10_2_RNAi24,1.7631444754057235e-06,2.822645675330078e-06,5.600176345439103e-07,8.752484832388531e-06,1.3898292617668243e-05
RBP10_3_RNAi24,2.176402151172859e-06,6.152438824593422e-07,0.0,7.707096563362765e-06,1.0498742596994967e-05
RBP33_1_RNAi48,3.939734420525403e-05,0.0001292288699579256,0.0009243505019659347,0.0009446249751677891,0.0020376016912969034
RBP42_1_KO24,6.671530780189594e-05,9.827188237931904e-06,6.635199290044092e-05,6.5661154004327615e-06,0.00014946060434070153
RBP42_1_KO48,2.7223791319489048e-05,3.08985236403557e-05,8.251575713071693e-05,1.7879402424583368e-05,0.00015851747451514506
RBP42_1_KO72,0.00016494523137617598,0.00015687886521298787,0.0004622397079296148,8.27650583183203e-05,0.0008668288628370989
RNaseH1_1_KO,7.0218893021732e-05,4.07087520052109e-06,1.9345818681118007e-06,5.102587734986901e-06,8.132693782535179e-05
RNaseH2A_1_RNAi24,0.00024720191187096085,0.00012019881502338125,7.938563288099719e-05,1.544376695808066e-05,0.00046223012673342
RNaseH2A_2_RNAi36,0.00032932588588318115,0.0002715469623887378,0.0002822115347196764,9.58781841472218e-05,0.0009789625671388171
SET27_1_KO,0.0003840781567569405,3.520658075490644e-05,9.755642105164396e-05,0.0002119166936671214,0.0007287578522306123
SET27_1_sKO,4.665762106733193e-05,5.9195575466210335e-06,3.056296425892091e-05,4.8273943684003514e-06,8.796753724127422e-05
SNF2PH_1_RNAi48,9.757084554068432e-06,8.746881598536014e-06,3.464032241709242e-05,1.084475314357885e-05,6.398904171327572e-05
TFR_1_RNAi24,2.951934047750229e-05,3.979148497227021e-05,2.9918924659719636e-05,1.2039810412773292e-05,0.00011126956052226542
TbATR_1_RNAi24,0.0006863277853560051,6.478273122211543e-05,9.609292315634988e-05,8.391226040281906e-05,0.0009311157001372894
TbATR_2_RNAi36,0.0029881165754311496,0.00038582221372657465,0.0005664981410759325,0.00033830708341740117,0.004278744013651058
TbESB1_1_RNAi24,0.0006202740865591191,1.1112014370394307e-05,6.523305518800344e-05,1.9392184078520608e-05,0.0007160113401960374
TbESB1_2_KO48,4.264059384191595e-05,1.1557226179423407e-05,0.0001566673799393234,5.713457400539609e-05,0.0002679997739660588
TbESB1_3_OE24,0.0034902328941460955,0.0001357646248962292,0.00027773871011040714,1.5946227000210227e-05,0.003919682456152942
TbHAT_1_RNAi48HAT1,4.049027361448319e-05,0.00010010970201294905,7.325926902508407e-05,3.7254032740073144e-05,0.00025111327739258944
TbHAT_1_RNAi48HAT2,0.00018198878068473588,4.741477350161727e-05,0.00014189714458430328,6.724066514463474e-05,0.00043854136391529116
TbPP1one_1_RNAi24,0.0018728354143413243,0.0018175817124319905,0.003741965088211981,0.0024357120414744107,0.009868094256459707
TbPP1seven_1_RNAi24,0.0,4.898965476215907e-07,0.0,1.324498589398061e-05,1.3734882441602201e-05
TbRAP1_1_2SD,0.0009520956545208813,0.0009370633732993065,0.0013003811650873485,0.0034075190179192845,0.006597059210826821
TbRAP1_1_5A,0.0006815231040572874,0.000425043727969053,0.0008888704071296673,0.0016654759312574705,0.003660913170413478
TbRAP1_1_KO,0.0017153552900258588,0.0014075006856916691,0.002104776766928133,0.0031439830470210844,0.008371615789666746
TbRAP1_2_dMyb,0.003250053388201296,0.002970889504389313,0.004079672574349349,0.00711739849757449,0.017418013964514447
TbSAP_1_RNAi72,0.00014462883087704197,4.714266903751881e-05,0.0007151520820950037,7.23596754586233e-05,0.0009792832574681877
VEX1_1_Oe72,0.00041288677064606135,0.00010147836976616802,0.00019232272896019047,9.314575186877727e-05,0.0007998336212411972
VEX1_2_RNAi72,0.0005089364488981261,0.00036495277417756866,0.00015286770403413635,0.00016042021201408528,0.0011871771391239164
VEX1_4_RNAi24,6.559019846630455e-05,1.8769698124217523e-05,5.8133773789871236e-05,1.2847961610023641e-05,0.00015534163199041695
VEX1_5_RNAi48,0.00047824131344709745,5.916166376201305e-05,0.00013139224457718018,1.4046418314686978e-05,0.0006828416401009777
VEX1_6_RNAi72,0.0004976864437116694,3.912495586467974e-05,0.00013137211645079181,1.5178054634609951e-05,0.0006833615706617508
VEX1and2_1_RNAi24,0.008740203232074289,0.0018667142401653754,0.002088033207163454,0.0005330865947757476,0.013228037274178867
VEX1and2_1_RNAi48,0.007621534279344235,0.0015837222835840773,0.0027981529679305932,0.0008041992753907466,0.012807608806249654
VEX2_1_RNAi24,0.015146229322682428,0.002006194230650309,0.0005387385622410911,0.0002249395647976709,0.0179161016803715
VEX2_1_RNAi48,0.012980716867798918,0.0017453192572218852,0.0004052725824191883,0.0002766117734112982,0.01540792048085129
ZC3H28_1_RNAi10,3.639695559265417e-07,7.889179156238015e-07,1.0641827173129717e-07,7.332120545149009e-07,1.9925177977965414e-06
ZC3H28_1_RNAi14,0.0,2.225847530286651e-06,0.0,3.5155914411038463e-06,5.741438971390497e-06
ZC3H28_1_RNAi16,1.4589603478580577e-07,8.394794921512872e-07,7.3703122810062e-08,9.849807713090306e-07,2.0440594210561855e-06
ZC3H28_1_RNAi24,0.0,1.7513013566986348e-07,9.858424953282429e-07,1.2213272619573232e-06,2.3822998929554295e-06
ZC3H40_1_RNAi72,0.0005720740804238132,7.08229715347123e-05,3.1136651188519924e-05,5.8162233031545364e-05,0.0007321959361785909
ZC3H5_2_RNAi12,3.5136571626131387e-07,6.880392453863187e-06,1.8669777596512535e-06,2.2587199099391043e-05,3.16859350291668e-05
ZC3H5_3_RNAi12,9.14365479561136e-07,5.614305140865015e-06,1.9951370266255152e-06,8.769645697863584e-06,1.729345334491525e-05
ZC3H5_4_RNAi12,2.139567651548375e-06,1.3560676136246152e-05,9.37168014454381e-06,9.103717756457231e-06,3.417564168879557e-05
ZC3H5_5_RNAi12,2.1496263605346606e-07,1.1012814501036876e-06,6.888013699491202e-07,5.104427480546688e-06,7.109472936652962e-06`;
            const mainCsvData = `Experiment,change
BDF2_1_KO48,0.0011625191820167982
BDF3_1_KO24,-0.008919620886485374
BET151_1_Drug12h,-0.010790928322649638
BET151_1_Drug24h,-0.02187425751068904
BET151_1_Drug3h,0.0010766769259458187
BET151_1_Drug48h,-0.03534898572577927
BET151_1_Drug6h,-0.008362373340291766
BET151_1_Drug72h,-0.036946953733599436
CAF1b_1_RNAi24,-0.012086879589415171
CFB2_1_RNAi9,-0.0020019792438769855
DFO_1_DFO,0.0011985466474251014
DFO_1_DFOFe,-0.0008557219240018857
DFO_1_Fe,0.0018552122098497298
DRBD18_1_RNAi12,-0.0037802455157021804
H1_1_RNAi96,-0.009585361369602384
H3H4_1_KOH3,-0.0093945200511052
H3H4_1_KOH3J,-0.0037667696016889796
H3H4_1_KOH4,-0.018090293220653884
H3H4_1_KOH4J,-0.017193522414203848
H3H4_1_KOJ2,-0.023537783649051704
H3H4_2_KO48,-0.012625015454517285
H3H4_3_KO48,-0.028538751595456824
H3_1_KOH3,-0.001290122289025506
H3_1_KOH3J,0.0019500984644124537
H3_1_KOJ,0.0001928624683203671
IPMK_1_RNAi36,-0.01253633387048221
IPMK_2_RNAi36,-0.006575646788261662
MCMBP_1_KO24,-0.002501316472208786
MCMBP_1_KO48,-0.008450159700305443
PIP5Pase_1_KO,-0.02459660297990932
PIP5Pase_2_D360A_N362A,0.003856447042876611
PNUTS_1_RNAi48,-0.0024223936208581168
RBP10_1_RNAi24,-0.0015167737640425592
RBP10_2_RNAi24,-0.014299024231171034
RBP10_3_RNAi24,-0.012054485768064862
RBP33_1_RNAi48,-0.02227852030313583
RBP42_1_KO24,0.0036388183816672727
RBP42_1_KO48,-0.00034209267074697056
RBP42_1_KO72,-0.003881078889443345
RNaseH1_1_KO,-0.002378353081158569
RNaseH2A_1_RNAi24,-0.01760990742361733
RNaseH2A_2_RNAi36,-0.04147007347378297
SET27_1_KO,0.0051341770928231
SET27_1_sKO,-0.0026270775025417983
SNF2PH_1_RNAi48,-0.0004215715452947008
TFR_1_RNAi24,-0.001852293608425995
TbATR_1_RNAi24,-0.005204844741337533
TbATR_2_RNAi36,-0.015336648092901129
TbESB1_1_RNAi24,-0.03304710914948843
TbESB1_2_KO48,-0.03335208773381453
TbESB1_3_OE24,-0.007213675578497621
TbHAT_1_RNAi48HAT1,-0.002735781582894465
TbHAT_1_RNAi48HAT2,-0.002520683786101704
TbPP1one_1_RNAi24,-0.0015480383623101852
TbPP1seven_1_RNAi24,-0.012499827412225557
TbRAP1_1_2SD,-0.0221365544925115
TbRAP1_1_5A,-0.02735509179162654
TbRAP1_1_KO,-0.009411578623953799
TbRAP1_2_dMyb,-0.01417747886514405
TbSAP_1_RNAi72,0.00019701513916233274
VEX1_1_Oe72,-0.003804904019000868
VEX1_2_RNAi72,0.0017593943463849425
VEX1_4_RNAi24,-0.000599819632555558
VEX1_5_RNAi48,-0.002597748716345407
VEX1_6_RNAi72,-0.00021831466446851217
VEX1and2_1_RNAi24,-0.008614795403333854
VEX1and2_1_RNAi48,-0.013810655744625502
VEX2_1_RNAi24,-0.01994473630942762
VEX2_1_RNAi48,-0.021525563177340966
ZC3H28_1_RNAi10,-0.0022564814360218587
ZC3H28_1_RNAi14,-0.010494522742744518
ZC3H28_1_RNAi16,-0.008997728654760988
ZC3H28_1_RNAi24,-0.011741551359685935
ZC3H40_1_RNAi72,-0.007243127680651218
ZC3H5_2_RNAi12,-0.000680722749461446
ZC3H5_3_RNAi12,0.00012824411229304857
ZC3H5_4_RNAi12,0.009983303251673147
ZC3H5_5_RNAi12,-0.0019597161055319515`;

            // --- DOM Elements ---
            const loader = document.getElementById('loader');
            const tooltip = document.getElementById('tooltip');
            const navSilent = document.getElementById('nav-silent');
            const navMain = document.getElementById('nav-main');
            const pageSilent = document.getElementById('page-silent');
            const pageMain = document.getElementById('page-main');

            // --- Leaderboard (Silent) Elements & State ---
            const leaderboardContainer = document.getElementById('leaderboard-container');
            const filtersSilent = document.getElementById('filters-silent');
            const expanderContainer = document.getElementById('expander-container');
            let silentData = [], currentSilentSort = 'sum', isExpanded = false;
            const itemHeightSilent = 76, displayLimit = 20;

            // --- Diverging Chart (Main) Elements & State ---
            const chartContainer = document.getElementById('chart-container');
            const filtersMain = document.getElementById('filters-main');
            let mainData = [], currentMainSort = 'magnitude';
            const itemHeightMain = 40;

            // --- App Initialization ---
            function init() {
                parseSilentData();
                parseMainData();
                
                createLeaderboardItems();
                createChartItems();
                
                renderLeaderboard();
                renderChart();

                loader.style.display = 'none';
                setupEventListeners();
            }

            // --- Navigation ---
            function switchPage(page) {
                if (page === 'silent') {
                    pageSilent.classList.add('active');
                    pageMain.classList.remove('active');
                    navSilent.classList.add('active');
                    navMain.classList.remove('active');
                } else {
                    pageSilent.classList.remove('active');
                    pageMain.classList.add('active');
                    navSilent.classList.remove('active');
                    navMain.classList.add('active');
                }
            }

            // --- Data Parsers ---
            function parseSilentData() {
                const lines = silentCsvData.trim().split('\n');
                const headers = lines[0].split(',').map(h => h.trim());
                silentData = lines.slice(1).map(line => {
                    const values = line.split(',');
                    const entry = {};
                    headers.forEach((h, i) => entry[h] = i === 0 ? values[i].trim() : parseFloat(values[i]) || 0);
                    return entry;
                }).filter(d => d.Experiment);
            }

            function parseMainData() {
                const lines = mainCsvData.trim().split('\n');
                const headers = lines[0].split(',').map(h => h.trim());
                mainData = lines.slice(1).map(line => {
                    const values = line.split(',');
                    const entry = {};
                    headers.forEach((h, i) => entry[h] = i === 0 ? values[i].trim() : parseFloat(values[i]) || 0);
                    entry.magnitude = Math.abs(entry.change);
                    return entry;
                }).filter(d => d.Experiment);
            }

            // --- LEADERBOARD (SILENT) FUNCTIONS ---
            function createLeaderboardItems() {
                silentData.forEach(item => {
                    const li = document.createElement('div');
                    li.className = 'leaderboard-item flex items-center p-3 bg-gray-800 rounded-lg shadow-md my-2';
                    li.dataset.experiment = item.Experiment;
                    li.innerHTML = `
                        <div class="rank-badge w-10 h-10 flex-shrink-0 items-center justify-center rounded-full bg-gray-700 font-bold text-lg mr-4 flex">
                            <span class="rank-text"></span>
                        </div>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-semibold text-white truncate">${item.Experiment}</p>
                            <div class="w-full bg-black/30 rounded-full h-2.5 mt-1 overflow-hidden">
                                <div class="bar bg-gradient-to-r from-indigo-500 to-purple-500 h-2.5 rounded-full" style="width: 0%; transition: width 0.6s ease;"></div>
                            </div>
                        </div>`;
                    
                    li.addEventListener('mouseover', () => {
                        tooltip.style.display = 'block';
                        const value = item[currentSilentSort];
                        tooltip.innerHTML = `<strong>${item.Experiment}</strong><br>${currentSilentSort.toUpperCase()}: ${value.toExponential(4)}`;
                    });
                    li.addEventListener('mouseout', () => {
                        tooltip.style.display = 'none';
                    });
                    li.addEventListener('mousemove', (e) => {
                        tooltip.style.left = `${e.clientX + 15}px`;
                        tooltip.style.top = `${e.clientY + 15}px`;
                    });

                    leaderboardContainer.appendChild(li);
                });
            }

            function renderLeaderboard() {
                silentData.sort((a, b) => b[currentSilentSort] - a[currentSilentSort]);
                const count = isExpanded ? silentData.length : Math.min(displayLimit, silentData.length);
                leaderboardContainer.style.height = `${count * itemHeightSilent}px`;
                const maxVal = silentData.length > 0 ? silentData[0][currentSilentSort] : 1;

                silentData.forEach((item, index) => {
                    const el = leaderboardContainer.querySelector(`[data-experiment="${item.Experiment}"]`);
                    if (!el) return;
                    el.style.transform = `translateY(${index * itemHeightSilent}px)`;
                    el.style.opacity = index < count ? '1' : '0';
                    el.style.pointerEvents = index < count ? 'auto' : 'none';

                    const rank = index + 1;
                    const rankBadge = el.querySelector('.rank-badge');
                    rankBadge.classList.remove('rank-1', 'rank-2', 'rank-3');
                    if (rank <= 3) rankBadge.classList.add(`rank-${rank}`);
                    
                    el.querySelector('.rank-text').textContent = rank;
                    el.querySelector('.bar').style.width = `${maxVal > 0 ? (item[currentSilentSort] / maxVal) * 100 : 0}%`;
                });
            }

            // --- DIVERGING CHART (MAIN) FUNCTIONS ---
            function createChartItems() {
                mainData.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'chart-item';
                    div.dataset.experiment = item.Experiment;
                    div.innerHTML = `<div class="bar-container"><div class="diverging-bar"></div><div class="item-label"></div></div>`;
                    
                    div.addEventListener('mouseover', () => {
                        tooltip.style.display = 'block';
                        tooltip.innerHTML = `<strong>${item.Experiment}</strong><br>Change: ${item.change.toExponential(4)}`;
                    });
                    div.addEventListener('mouseout', () => {
                        tooltip.style.display = 'none';
                    });
                    div.addEventListener('mousemove', (e) => {
                        tooltip.style.left = `${e.clientX + 15}px`;
                        tooltip.style.top = `${e.clientY + 15}px`;
                    });

                    chartContainer.appendChild(div);
                });
            }

            function renderChart() {
                let filteredData = [...mainData];
                if (currentMainSort === 'up') filteredData = mainData.filter(d => d.change > 0);
                else if (currentMainSort === 'down') filteredData = mainData.filter(d => d.change < 0);

                filteredData.sort((a, b) => {
                    if (currentMainSort === 'up') return b.change - a.change;
                    if (currentMainSort === 'down') return a.change - b.change;
                    return b.magnitude - a.magnitude;
                });

                chartContainer.style.height = `${filteredData.length * itemHeightMain}px`;
                const maxMagnitude = Math.max(...mainData.map(d => d.magnitude));
                
                chartContainer.querySelectorAll('.chart-item').forEach(el => el.style.display = 'none');
                
                filteredData.forEach((item, index) => {
                    const el = chartContainer.querySelector(`[data-experiment="${item.Experiment}"]`);
                    if (!el) return;
                    el.style.display = 'flex';
                    el.style.transform = `translateY(${index * itemHeightMain}px)`;

                    const bar = el.querySelector('.diverging-bar');
                    const label = el.querySelector('.item-label');
                    const barWidth = maxMagnitude > 0 ? (item.magnitude / maxMagnitude) * 50 : 0;
                    
                    bar.style.width = `${barWidth}%`;

                    if (item.change >= 0) {
                        bar.className = 'diverging-bar bar-up';
                        label.style.left = '51%'; label.style.right = 'auto';
                    } else {
                        bar.className = 'diverging-bar bar-down';
                        label.style.right = '51%'; label.style.left = 'auto';
                    }
                    label.textContent = item.Experiment;
                });
            }

            // --- Event Listeners Setup ---
            function setupEventListeners() {
                navSilent.addEventListener('click', (e) => { e.preventDefault(); switchPage('silent'); });
                navMain.addEventListener('click', (e) => { e.preventDefault(); switchPage('main'); });

                filtersSilent.addEventListener('click', (e) => {
                    if (e.target.tagName === 'BUTTON') {
                        currentSilentSort = e.target.dataset.sort;
                        filtersSilent.querySelector('.active').classList.remove('active');
                        e.target.classList.add('active');
                        renderLeaderboard();
                    }
                });

                if (silentData.length > displayLimit) {
                    const btn = document.createElement('button');
                    btn.className = 'filter-btn font-semibold py-2 px-5 rounded-full bg-gray-700 hover:bg-gray-600';
                    btn.textContent = `Show All (${silentData.length})`;
                    expanderContainer.appendChild(btn);
                    btn.addEventListener('click', () => {
                        isExpanded = !isExpanded;
                        btn.textContent = isExpanded ? 'Show Less' : `Show All (${silentData.length})`;
                        renderLeaderboard();
                    });
                }

                filtersMain.addEventListener('click', (e) => {
                    if (e.target.tagName === 'BUTTON') {
                        currentMainSort = e.target.dataset.sort;
                        filtersMain.querySelector('.active').classList.remove('active');
                        e.target.classList.add('active');
                        renderChart();
                    }
                });
            }

            init();
        });
    </script>
</body>
</html>